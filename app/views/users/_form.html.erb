<%= form_for(@user) do |f| %>
    <%= image_tag(avatar_url(@user), class:"img-user img-thumbnail", id: 'img_prev')%>
    <%= f.label :picture %>
      <%= f.file_field :picture, 
      accept:  'image/jpeg,image/gif,image/png', 
      class: 'form-control mb-2 photo_upload'%> 
    
    <%= render 'shared/error_messages', object: f.object %>
    <%= f.label :name %>
    <%= f.text_field :name, class: 'form-control' %>
    <%= f.label :email %>
    <%= f.email_field :email, class: 'form-control' %>
    <%= f.label :password %>
    <%= f.password_field :password, class: 'form-control' %>
    <%= f.label :password_confirmation %>
    <%= f.password_field :password_confirmation, class: 'form-control'
    %>
    <%= f.submit yield(:button_text), class: "btn btn-primary mx-auto m-auto d-block" %>
<% end %>
<!-- Assume jQuery is loaded -->
<script>
  function readURL(input) {
    if (input.files && input.files[0]) {
      var reader = new FileReader();

      reader.onload = function (e) {
        $('#img_prev').attr('src', e.target.result)
      };

      reader.readAsDataURL(input.files[0]);
    }
  }
  $(".photo_upload").change(function(){
    readURL(this);
  });
</script>